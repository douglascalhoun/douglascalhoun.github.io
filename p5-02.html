<html><head><style>
body {
  margin: 0;
  padding: 0;
}
#container {
  max-width: 640px;
  margin: 0 auto;
}
</style></head><body>

<script src='js/p5.js'></script>
<script src='js/utils.js'></script>
<script>
var toggle, context, messages = ["OH NO", "WHAT'S THIS?", "THIS ISN'T NORMAL", "PLEASE REMAIN CALM", "NOTHING IS WRONG", "THIS IS A TEST", "YES, THAT'S RIGHT", "THIS IS ONLY A TEST", "THIS WILL ALL BE OVER IN JUST A MOMENT", "EVERYTHING WILL SOON RETURN TO NORMAL", "JUST A MOMENT", "JUST A MOMENT...", "JUST. A. MOMENT.","JUST", "A", "MOMENT", "ALMOST THERE", "RETURNING TO NORMAL", "ANY SECOND NOW", "ANY SECOND", "AAAANNNNYYY"]

var alarm = setInterval(messages.shift.bind(messages), 2000)

function setup () {
  createCanvas(innerWidth, innerHeight)
  frameRate(4)
  textAlign(CENTER,CENTER)
  textStyle(BOLD)
  textSize(width/14)

  context = new AudioContext()

  var osc = context.createOscillator()
  osc.frequency.value = 540
  osc.connect(context.destination)
  osc.start(0)

  var gain = context.createGain()
  gain.gain.value = 100
  gain.connect(osc.frequency)

  var osc2 = context.createOscillator()
  osc2.frequency.value = 1
  osc2.type = "square"
  osc2.connect(gain)

  osc2.start(0)
}

function draw () {
  if (messages.length){
    if (toggle = !toggle) {
      background(255,0,0)
      fill(0,0,225)
    } else {
      background(0,0,225)
      fill(255,0,0)
    }
    text(messages[0], 0, 0, width, height)
  } else {
    noLoop()
    context.close(0)
    clearInterval(alarm)
    background(0)
    fill(255)
    textSize(width/5)
    text("NORMAL", 0, 0, width, height)

  }
}
</script></body></html>
